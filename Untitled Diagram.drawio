<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 OPR/115.0.0.0" version="26.0.3">
  <diagram name="Page-1" id="JwLQiluCDj7BUVWrhCS6">
    <mxGraphModel dx="1032" dy="5995" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-1" target="OvHRCUOQNgS_uRx5AtUm-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-1" value="ROOM" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="200" y="160" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-2" value="&lt;b&gt;LEGENDS&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="130" width="120" height="150" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="kceuGKvt7hz0_VKH2Cjf-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="xqzXWwxne0dO0nGygCqp-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-tVxKX45YJ9eaGW1tU2y-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="-tVxKX45YJ9eaGW1tU2y-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-tVxKX45YJ9eaGW1tU2y-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="-tVxKX45YJ9eaGW1tU2y-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="JLu_9honwRpLykDaQ8XI-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="JLu_9honwRpLykDaQ8XI-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="JLu_9honwRpLykDaQ8XI-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="JLu_9honwRpLykDaQ8XI-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-4" value="Models" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="360" y="40" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0.004;entryY=0.633;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-1" target="kceuGKvt7hz0_VKH2Cjf-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-10" value="&lt;b&gt;Room&lt;/b&gt;&lt;div&gt;name(string&lt;b&gt;),&lt;/b&gt;&lt;/div&gt;&lt;div&gt;category_ref,&lt;/div&gt;&lt;div&gt;min_capacity(min number of users required),&lt;/div&gt;&lt;div&gt;max_capacity(max number users allowed),&lt;/div&gt;&lt;div&gt;privacy(enum: private, public),&lt;/div&gt;&lt;div&gt;plans(array(....room_plans)),&lt;/div&gt;&lt;div&gt;hoh(user_ref, #note 0 for the platform),&lt;/div&gt;&lt;div&gt;setting_ref,&lt;/div&gt;&lt;div&gt;allow_dynamic_entry,&lt;/div&gt;&lt;div&gt;&lt;div&gt;params(array of sub_docs(data: json_string, name: string, type: enum(number, price, float, string, obj, file), required: boolean, when: enum(pre_play, in_play etc...), default ), nullable),&lt;/div&gt;&lt;div&gt;data(sub_doc(&lt;span style=&quot;background-color: initial;&quot;&gt;array of sub_docs(name: string, source: enum(permission, landlord, room, all_global_datas(each passed as an array of keys, these keys according to their index will be used to transverse global datas to get the specific data intended) ), ref(sub_doc(ref, target: string(#note path is a string of keys seperated by a &quot;,&quot;, it maps out the path to the data), collection: string(name of collection in db) ), nullable) )&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="520" width="320" height="390" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-11" value="&lt;b&gt;Category&lt;/b&gt;&lt;div&gt;name,&lt;/div&gt;&lt;div&gt;description,&lt;/div&gt;&lt;div&gt;parent_ref(nullable),&lt;/div&gt;&lt;div&gt;hooks(array(hook_ref)),&lt;/div&gt;&lt;div&gt;permissions(array(permision_ref), nullable ),&lt;/div&gt;&lt;div&gt;plans(array(category_plan)),&lt;/div&gt;&lt;div&gt;capacity,&lt;/div&gt;&lt;div&gt;current_capacity,&lt;/div&gt;&lt;div&gt;status(enum: active, inactive),&lt;/div&gt;&lt;div&gt;rent_allowed(boolean)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="520" y="-240" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="kceuGKvt7hz0_VKH2Cjf-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0.015;entryY=0.207;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="kceuGKvt7hz0_VKH2Cjf-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-2" value="&lt;b&gt;Attendance&lt;/b&gt;&lt;div&gt;sub_room_ref,&lt;/div&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;joined(timestamp),&lt;/div&gt;&lt;div&gt;left(timestamp, nullable),&lt;/div&gt;&lt;div&gt;index(number #note this is the users position joining the room)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="520" y="-480" width="240" height="200" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-3" value="&lt;b&gt;Room Plans&lt;/b&gt;&lt;div&gt;category(category_ref, nullable),&lt;div&gt;&lt;div&gt;&lt;div&gt;capacity(number, nullable),&lt;/div&gt;&lt;div&gt;plan(enum(rent, pass_code, sub)),&lt;/div&gt;&lt;div&gt;price(sub_doc(amnt: money, denominatn_ref),),&lt;/div&gt;&lt;div&gt;denominations(array of denomination_refs),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;interval(enum(monthly, yearlyt), nullable),&lt;/div&gt;&lt;div&gt;sub_rooms_allowed(number, nulable #note default is 1 for private rooms and its not applicable to public rooms),&lt;/div&gt;&lt;div&gt;&lt;div&gt;shared_codes(array(sub_doc(code: string(platform_generated_secured_pass_code), expires(timestamp, nullable), expired(boolean) )), nullable),&lt;/div&gt;&lt;div&gt;manual_codes(array(sub_doc(code: user_provided_code, expires(timestamp), expired(boolean)),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;others&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#note default denomination is the denomination ref at index &quot;0&quot; in the denominations array.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-840" width="320" height="320" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-4" value="&lt;b&gt;Room Setting&lt;/b&gt;&lt;div&gt;room(collection(string), ref),&lt;br&gt;&lt;div&gt;guest_url(string, nullable #only applicable to sub-rooms and optional for private sub-rooms),&lt;/div&gt;&lt;div&gt;hooks(array(hook_ref), nullable #only applies to private rooms),&lt;/div&gt;&lt;div&gt;staff_size,&lt;/div&gt;&lt;div&gt;public_access(array() from [view, follow, comment])&lt;/div&gt;&lt;div&gt;greetings(string, nullable),&lt;/div&gt;&lt;div&gt;logo(string, nullable #note path to the rooms logo),&lt;/div&gt;&lt;div&gt;banner(string, nullable #path to the rooms banner),&lt;/div&gt;&lt;div&gt;background_media(sub_doc(media(enum: image, audio, video), path(string) ) ),&lt;/div&gt;&lt;div&gt;permissions(array(permission_ref)),&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-1240" width="320" height="320" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-6" value="&lt;b&gt;User room plans&lt;/b&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;room_ref,&lt;/div&gt;&lt;div&gt;for(sub_doc(type(enum: ownership, guest, staff, app, renters), ref(room_plan_ref, nullable #note tobe set if type is in [guest, staff, app]) ) ),&lt;/div&gt;&lt;div&gt;qty(nullable),&lt;/div&gt;&lt;div&gt;transaction_ref(nullable),&lt;/div&gt;&lt;div&gt;contracts(array(contract_ref), nullable),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;expires(timestamp, nullable),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;status(enum: active, inactive)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-1530" width="320" height="210" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-7" value="&lt;b&gt;Sub-Room&lt;/b&gt;&lt;div&gt;room_ref,&lt;/div&gt;&lt;div&gt;plans(array(sub_room_plan_ref), nullable),&lt;/div&gt;&lt;div&gt;privacy(enum(public, private), default(public) ),&lt;/div&gt;&lt;div&gt;&lt;div&gt;rating(number #note the number represents a percentage),&lt;/div&gt;&lt;div&gt;mayor(user_ref, nullable #note only applicable for public rooms that have achieved seriousness, it is set by a vote from the current members of the sub-room with active),&lt;/div&gt;&lt;div&gt;guest_mode(enums(plan, free), default(free) #note free by default for all sub-rooms, can only be updated by the landlord(app or user that have the proper authorization for the room) or users with active contract for this sub-room),&lt;/div&gt;&lt;div&gt;seriousness(sub_doc(state(enum(achieched, lost, not_achieved), achieved_on(timestamp, nullable), lost_on(timestamp, nullable), basking_till(timestamp, nullable)&amp;nbsp; ) ) ),&lt;/div&gt;&lt;div&gt;status(enum: live, dead, asleep) ,&lt;/div&gt;&lt;/div&gt;&lt;div&gt;privacy(enum: private, public),&lt;/div&gt;&lt;div&gt;capacity(number),&lt;/div&gt;&lt;div&gt;live_capacity(number)&lt;/div&gt;&lt;div&gt;name(string&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;, nullable #note name will only be set for sub-rooms that have achieved the qualified average rating&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;setting(ref, nullable #note only for private sub-rooms and public sub-rooms that have achieved seriousness),&lt;/div&gt;&lt;div&gt;&lt;div&gt;params(array of sub_docs(data: json_string, name: string, type: enum(number, price, float, string, obj, file), required: boolean, when: enum(pre_play, in_play etc...), default ), nullable),&lt;/div&gt;&lt;div&gt;data(sub_doc(&lt;span style=&quot;background-color: initial;&quot;&gt;array of sub_docs(name: string, source: enum(permission, landlord, room, all_global_datas(each passed as an array of keys, these keys according to their index will be used to transverse global datas to get the specific data intended) ), ref(sub_doc(ref, target: string(#note path is a string of keys seperated by a &quot;,&quot;, it maps out the path to the data), collection: string(name of collection in db) ), nullable) )&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-2120" width="520" height="510" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-9" value="&lt;b&gt;User sub-rooms access&lt;/b&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;sub_room_ref,&lt;/div&gt;&lt;div&gt;user_sub_room_plan_ref,&lt;/div&gt;&lt;div&gt;&lt;div&gt;pass_code(sub_doc(code: string, mode(enum: manual,share), expires(timestamp, nullable)), nullable),&lt;/div&gt;&lt;div&gt;room_data(array(sub_doc(value: json_string, path: string))),&lt;/div&gt;&lt;div&gt;permissions(array(sub_doc(permission_ref, expires(timestamp, nullable)) ), nullable ),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;level(enum(achieved_tenancy, landlord, tenancy, guest, staff etc) ),&lt;/div&gt;&lt;div&gt;status(enum(active, inactive) ),&lt;/div&gt;&lt;div&gt;role_ref,,&lt;/div&gt;&lt;div&gt;default(boolean)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-2420" width="360" height="260" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-10" value="&lt;b&gt;Sub_room Plan&lt;/b&gt;&lt;div&gt;sub_room_ref,&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;plan(enum: otp_in_place, otp_removed, sub, pass_code),&lt;/div&gt;&lt;div&gt;type(enum(user, app)),&lt;/div&gt;&lt;div&gt;price(sub_doc(amnt: money, denominatn_ref), nullable),&lt;/div&gt;&lt;div&gt;denominations(array of denomination_refs, nullable),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;interval(enum(hourly, daily, weekly monthly, yearlyt), nullable),&lt;/div&gt;&lt;div&gt;capacity,&lt;/div&gt;&lt;div&gt;&lt;div&gt;shared_codes(array(sub_doc(code: string(platform_generated_secured_pass_code), expires(timestamp, nullable), expired(boolean) )), nullable),&lt;/div&gt;&lt;div&gt;manual_codes(array(sub_doc(code: user_provided_code, expires(timestamp), expired(boolean)),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#note default denomination is the denomination ref at index &quot;0&quot; in the denominations array.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-2840" width="320" height="280" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0.003;entryY=0.552;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bkT-c7pUdsVTCy2Co1-N-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0.001;entryY=0.621;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="kceuGKvt7hz0_VKH2Cjf-4" target="bkT-c7pUdsVTCy2Co1-N-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="OvHRCUOQNgS_uRx5AtUm-1" target="OvHRCUOQNgS_uRx5AtUm-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="OvHRCUOQNgS_uRx5AtUm-1" target="xqzXWwxne0dO0nGygCqp-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-1" value="&lt;b&gt;Processes&lt;/b&gt;" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;" parent="1" vertex="1">
          <mxGeometry x="360" y="520" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="OvHRCUOQNgS_uRx5AtUm-2" target="OvHRCUOQNgS_uRx5AtUm-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="OvHRCUOQNgS_uRx5AtUm-2" target="OvHRCUOQNgS_uRx5AtUm-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="OvHRCUOQNgS_uRx5AtUm-2" target="JLu_9honwRpLykDaQ8XI-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-2" value="&lt;b&gt;Category&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="520" y="540" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="740" y="660" as="sourcePoint" />
            <mxPoint x="740" y="660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="OvHRCUOQNgS_uRx5AtUm-21" target="OvHRCUOQNgS_uRx5AtUm-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="OvHRCUOQNgS_uRx5AtUm-21" target="OvHRCUOQNgS_uRx5AtUm-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-21" value="&lt;b&gt;Creation&lt;/b&gt;&lt;div&gt;collect data&lt;/div&gt;&lt;div&gt;validate&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="570" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="OvHRCUOQNgS_uRx5AtUm-22" target="OvHRCUOQNgS_uRx5AtUm-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-22" value="&lt;b&gt;Validation failed&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="520" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-27" value="&lt;b&gt;Create category&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="870" y="570" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="OvHRCUOQNgS_uRx5AtUm-29" value="&lt;b&gt;Get&lt;/b&gt;&lt;div&gt;query for the category,&lt;/div&gt;&lt;div&gt;query for all categories where categories[].parent_ref is equal to category.id,&lt;/div&gt;&lt;div&gt;query for all rooms where room[].category_ref is equal to category.id or null(for category-less rooms they go with all categories),&lt;/div&gt;&lt;div&gt;return: category, childs(array of categories), rooms(array of rooms(either where rooms[].category_ref equals category.id or null) ),&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="660" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="xqzXWwxne0dO0nGygCqp-3" target="xqzXWwxne0dO0nGygCqp-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="xqzXWwxne0dO0nGygCqp-3" target="xqzXWwxne0dO0nGygCqp-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="xqzXWwxne0dO0nGygCqp-3" target="xqzXWwxne0dO0nGygCqp-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-3" value="&lt;b&gt;Room&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="520" y="1040" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="xqzXWwxne0dO0nGygCqp-4" target="JLu_9honwRpLykDaQ8XI-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="xqzXWwxne0dO0nGygCqp-4" target="JLu_9honwRpLykDaQ8XI-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-4" value="&lt;b&gt;Create Room&lt;/b&gt;&lt;div&gt;using provided category_ref and collected data create a room_doc.&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="850" y="1000" width="240" height="120" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-5" value="&lt;b&gt;Validation failed&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="1000" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="xqzXWwxne0dO0nGygCqp-6" target="xqzXWwxne0dO0nGygCqp-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="xqzXWwxne0dO0nGygCqp-6" target="xqzXWwxne0dO0nGygCqp-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-6" value="&lt;b&gt;Creation&lt;/b&gt;&lt;div&gt;collect data,&lt;/div&gt;&lt;div&gt;validate date&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="1080" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-12" value="&lt;b&gt;Get&lt;/b&gt;&lt;div&gt;query for the room,&lt;/div&gt;&lt;div&gt;query for all sub_rooms where sub_rooms[].room_ref equals room.id,&lt;/div&gt;&lt;div&gt;return: room, sub_rooms(array of sub_rooms)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="1200" width="280" height="130" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-23" value="&lt;b&gt;Join sub-room&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1220" y="1580" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-25" value="&lt;b&gt;User_sub_room_plan&lt;/b&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;sub_room_ref,&lt;/div&gt;&lt;div&gt;&lt;div&gt;plan(sub_doc(type(enum: ownership, guest, staff, app), ref(sub_room_plan_ref, nullable #note tobe set if type is in [guest, staff, app]) ) ),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;qty(nullable),&lt;/div&gt;&lt;div&gt;transaction_ref(nullable),&lt;/div&gt;&lt;div&gt;contracts(array(contract_ref))&lt;/div&gt;&lt;div&gt;expires(timestamp, nullable)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-3140" width="320" height="180" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-32" value="&lt;b&gt;Enter room&lt;/b&gt;&lt;div&gt;&lt;div&gt;get users active user_room_access,&lt;/div&gt;&lt;div&gt;for each&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_room_access,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;validate the default user_room_access.permissions,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;validate the default&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_room_access.plan,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;validate the default&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_room_access.params,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;validate the default&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_room_access.role&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="680" y="1760" width="240" height="160" as="geometry" />
        </mxCell>
        <mxCell id="xqzXWwxne0dO0nGygCqp-43" value="&lt;b&gt;Finish room setup&lt;/b&gt;&lt;br&gt;&lt;div&gt;set room.plans,&lt;/div&gt;&lt;div&gt;set hoh(current user_ref),&lt;/div&gt;&lt;div&gt;set room.settings,&lt;/div&gt;&lt;div&gt;set room.params&lt;/div&gt;&lt;div&gt;save room.&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1920" y="1000" width="200" height="120" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="kvjalDzr84s7akkoXQtF-3" target="JLu_9honwRpLykDaQ8XI-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kvjalDzr84s7akkoXQtF-3" target="JLu_9honwRpLykDaQ8XI-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kvjalDzr84s7akkoXQtF-3" value="&lt;b&gt;Payment&lt;/b&gt;&lt;div&gt;facilitate payment based on the plan the user choose&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1440" y="1050" width="220" height="70" as="geometry" />
        </mxCell>
        <mxCell id="-tVxKX45YJ9eaGW1tU2y-1" value="&lt;b&gt;User room access&lt;/b&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;room_ref&lt;/div&gt;&lt;div&gt;user_room_plan_ref,&lt;/div&gt;&lt;div&gt;&lt;div&gt;pass_code(sub_doc(code: string, mode(enum: manual,share), expires(timestamp, nullable)), nullable),&lt;/div&gt;&lt;div&gt;room_data(array(sub_doc(value: json_string, path: string))),&lt;/div&gt;&lt;div&gt;permissions(array(sub_doc(permission_ref, expires(timestamp, nullable)) ), nullable ),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;level(enum(owner, guest, staff, renter etc) ),&lt;/div&gt;&lt;div&gt;status(enum(active, inactive) ),&lt;/div&gt;&lt;div&gt;role_ref,,&lt;/div&gt;&lt;div&gt;default(boolean)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-3510" width="360" height="260" as="geometry" />
        </mxCell>
        <mxCell id="-tVxKX45YJ9eaGW1tU2y-3" value="&lt;b&gt;Roles&lt;/b&gt;&lt;div&gt;subject_ref,&lt;/div&gt;&lt;div&gt;name,&lt;/div&gt;&lt;div&gt;description,&lt;/div&gt;&lt;div&gt;permissions(array(permission_ref)),&lt;/div&gt;&lt;div&gt;creator(sub_doc(creator(for(ref, nullable), collection(enum(...collections)) ), nullable),&lt;/div&gt;&lt;div&gt;status(enum: active, inactive)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="480" y="-3760" width="360" height="160" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-1" target="kvjalDzr84s7akkoXQtF-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-1" target="JLu_9honwRpLykDaQ8XI-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-1" value="&lt;b&gt;Private&lt;/b&gt;&lt;div&gt;validate room.parent.rent_allowed,&lt;br&gt;&lt;div&gt;validate room.parent.capacity(checks if room is available for rent)&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1160" y="1080" width="220" height="100" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-2" target="xqzXWwxne0dO0nGygCqp-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-2" value="&lt;b&gt;Public&lt;/b&gt;&lt;div&gt;add free plan to room.plans,&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1200" y="980" width="140" height="80" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-3" value="&lt;b&gt;Category_plan&lt;/b&gt;&lt;br&gt;&lt;div&gt;category_ref,&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;plan(enum: rent, pass_code),&lt;/div&gt;&lt;div&gt;type(enum(user, app)),&lt;/div&gt;&lt;div&gt;price(sub_doc(amnt: money, denominatn_ref), nullable),&lt;/div&gt;&lt;div&gt;denominations(array of denomination_refs, nullable),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;interval(enum(monthly, yearlyt), nullable),&lt;/div&gt;&lt;div&gt;&lt;div&gt;shared_codes(array(sub_doc(code: string(platform_generated_secured_pass_code), expires(timestamp, nullable), expired(boolean) )), nullable),&lt;/div&gt;&lt;div&gt;manual_codes(array(sub_doc(code: user_provided_code, expires(timestamp), expired(boolean)),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#note default denomination is the denomination ref at index &quot;0&quot; in the denominations array.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="-4120" width="360" height="280" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-4" value="&lt;b&gt;User_category_access&lt;/b&gt;&lt;div&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;user_category_plan_ref&lt;/div&gt;&lt;div&gt;&lt;div&gt;pass_code(sub_doc(code: string, mode(enum: manual,share), expires(timestamp, nullable)), nullable),&lt;/div&gt;&lt;div&gt;category_data(array(sub_doc(value: json_string, path: string))),&lt;/div&gt;&lt;div&gt;permissions(array(sub_doc(permission_ref, expires(timestamp, nullable)) ), nullable ),&lt;/div&gt;&lt;/div&gt;&lt;div&gt;level(enum(renter, guest, staff, app, etc) ),&lt;/div&gt;&lt;div&gt;status(enum(active, inactive) ),&lt;/div&gt;&lt;div&gt;role_ref,&lt;/div&gt;&lt;/div&gt;&lt;div&gt;default(boolean)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="-4640" width="360" height="200" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-5" value="&lt;b&gt;App_user_rent&lt;/b&gt;&lt;div&gt;room_ref&lt;br&gt;&lt;div&gt;plan(category_plan),&lt;/div&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;transaction_ref(nullable),&lt;/div&gt;&lt;div&gt;expires(timestamp)&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="-4360" width="360" height="160" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-6" value="&lt;b&gt;User_category_plan&lt;/b&gt;&lt;div&gt;&lt;div&gt;user_ref,&lt;/div&gt;&lt;div&gt;category_ref,&lt;/div&gt;&lt;div&gt;plan(category_plan_ref),&lt;/div&gt;&lt;div&gt;contracts(array(contract_ref))&lt;/div&gt;&lt;div&gt;expires(timestamp, nullable)&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="-4880" width="360" height="160" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-12" target="JLu_9honwRpLykDaQ8XI-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-12" value="&lt;b&gt;Payment failed&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1400" y="1220" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-15" target="xqzXWwxne0dO0nGygCqp-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-15" value="&lt;b&gt;Payment succesfull&lt;/b&gt;&lt;div&gt;create app_user_rent for the room,&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1700" y="1040" width="140" height="80" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-23" target="JLu_9honwRpLykDaQ8XI-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-23" target="JLu_9honwRpLykDaQ8XI-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-23" value="&lt;b&gt;Access&lt;/b&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;collate user access,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user gets limited read only access,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user gets join_room access&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="900" width="190" height="70" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-24" target="JLu_9honwRpLykDaQ8XI-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-24" value="&lt;b&gt;If not category_access&lt;/b&gt;&lt;div&gt;gets&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1280" y="620" width="190" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-25" target="JLu_9honwRpLykDaQ8XI-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-25" target="JLu_9honwRpLykDaQ8XI-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-25" value="&lt;b&gt;If user have active [user_category_access]&lt;/b&gt;&lt;div&gt;for each user_category_acess,&lt;br&gt;&lt;div&gt;validate the default user_category_access.&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_category_plan&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;validate&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_category_access.&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;permissions,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); background-color: transparent;&quot;&gt;validate&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); background-color: transparent;&quot;&gt;user_category_access.role&lt;/span&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); background-color: transparent;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;user gets the&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;user_category_access.role access&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1280" y="710" width="307.5" height="120" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-26" target="JLu_9honwRpLykDaQ8XI-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-26" value="&lt;b&gt;Validation failed&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1120" y="790" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-39" value="&lt;b&gt;User access&lt;/b&gt;&lt;div&gt;user interacts with category based on what their acquired accesses allows,&lt;/div&gt;&lt;div&gt;user can toggle between acquired roles to manage and streamline their interactions(the default access/role is the initial role until its changed, the new access/role is validated).&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1660" y="600" width="260" height="140" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-45" value="&lt;b&gt;Collate accesses/roles&lt;/b&gt;&lt;div&gt;set user roles/accesses for this room,&lt;/div&gt;&lt;div&gt;user interact with the room as dictated by their accesses/roles,&lt;/div&gt;&lt;div&gt;user can toggle between these roles/accesses to manage, streamline and focus their interactions with room&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="990" y="1760" width="230" height="150" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-46" value="&lt;b&gt;Public&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1265" y="1750" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="JLu_9honwRpLykDaQ8XI-48" target="xqzXWwxne0dO0nGygCqp-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-48" value="&lt;b&gt;Validation failed&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1145" y="1240" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="JLu_9honwRpLykDaQ8XI-52" value="&lt;b&gt;Validation failed&lt;/b&gt;&lt;div&gt;prompt for access/role change providing them their available options&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="720" y="1980" width="190" height="100" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
